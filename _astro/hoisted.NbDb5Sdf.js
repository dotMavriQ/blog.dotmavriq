import"./hoisted.DZlar31k.js";const M=6,p=document.getElementById("blog-search"),z=document.querySelectorAll("#blog-grid > a"),S=document.querySelectorAll('[data-js="tag-filter"] button'),g=document.getElementById("filter-count"),y=document.querySelector('[data-tag="__all__"]'),U=document.getElementById("load-more-btn"),_=document.getElementById("load-more-wrap"),l=new Set;let c="",v=M,x,m=null,b=null,w=!1;async function C(){if(!(m||w)){w=!0;try{m=await(await fetch("/search-index.json")).json(),b=new Map(m.map(e=>[e.slug,e]))}catch{}w=!1}}function $(){const t=new URL(window.location.href);l.size?t.searchParams.set("tags",[...l].join(",")):t.searchParams.delete("tags"),c?t.searchParams.set("q",c):t.searchParams.delete("q"),history.replaceState(null,"",t)}function F(t,e,s){if(Math.abs(t.length-e.length)>s)return s+1;const r=Array.from({length:e.length+1},(a,n)=>n),o=new Array(e.length+1);for(let a=1;a<=t.length;a++){o[0]=a;for(let n=1;n<=e.length;n++)o[n]=t[a-1]===e[n-1]?r[n-1]:1+Math.min(r[n-1],r[n],o[n-1]);for(let n=0;n<=e.length;n++)r[n]=o[n]}return r[e.length]}function Q(t){return t<=4?0:t<=7?1:t<=11?2:3}function D(t,e){let s=0;const r=Q(t.length);for(const o of e){if(o===t){s=Math.max(s,100);break}if(o.includes(t)){s=Math.max(s,85);continue}if(r>0){const a=F(t,o,r);a<=r&&(s=Math.max(s,70-a*15))}}return s}function h(t,e){if(!e.length)return 0;let s=0;for(const r of t){const o=D(r,e);if(o===0)return 0;s+=o}return s/t.length}function u(t){return t.toLowerCase().split(/[\s,.:;!?'"_\-/\\()\[\]{}|]+/).filter(e=>e.length>0)}function G(t){if(!c)return 1;const e=c.toLowerCase(),s=u(e);if(!s.length)return 1;const r=t.dataset.slug||"",o=b?.get(r),a=t.dataset.title||"",n=t.dataset.excerpt||"",i=t.dataset.tags||"",d=o?.body??"";if(a.includes(e))return 1e3;if(d.toLowerCase().includes(e))return 500;if(n.includes(e))return 400;if(i.toLowerCase().includes(e))return 450;const I=u(a),R=u(n),j=u(i),q=d?u(d):[],P=h(s,I)*4,T=h(s,j)*2.5,W=h(s,R)*1.5,k=h(s,q)*1,E=Math.max(P,T,W,k);return E>0?E:0}function f(){const t=!l.size,e=!!c||!t,s=[];if(z.forEach(a=>{const n=a.dataset.tags?.split(",")??[],i=t||[...l].every(d=>n.includes(d));s.push({el:a,score:i?G(a):0})}),c){s.sort((n,i)=>i.score-n.score);const a=document.getElementById("blog-grid");if(a)for(const{el:n}of s)a.appendChild(n)}let r=0,o=0;s.forEach(({el:a,score:n})=>{if(n>0){r++;const i=e||r<=v;a.classList.toggle("card-hidden",!i),i&&o++}else a.classList.add("card-hidden")}),y&&(y.dataset.active=String(t),y.setAttribute("aria-pressed",String(t))),_&&_.classList.toggle("hidden",e||v>=r),g&&(t&&!c?g.classList.add("hidden"):(g.textContent=`${o} result${o!==1?"s":""}`,g.classList.remove("hidden"))),$()}S.forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.tag;e&&(e==="__all__"?(l.clear(),S.forEach(s=>{s.dataset.tag!=="__all__"&&(s.dataset.active="false",s.setAttribute("aria-pressed","false"))})):l.has(e)?(l.delete(e),t.dataset.active="false",t.setAttribute("aria-pressed","false")):(l.add(e),t.dataset.active="true",t.setAttribute("aria-pressed","true")),f())})});p?.addEventListener("input",()=>{clearTimeout(x),x=setTimeout(async()=>{c=p.value.trim(),c&&!m&&await C(),f()},150)});U?.addEventListener("click",()=>{v+=M,f()});const B=new URL(window.location.href).searchParams,A=B.get("tags");if(A)for(const t of A.split(",")){const e=document.querySelector(`[data-tag="${CSS.escape(t)}"]`);e&&(l.add(t),e.dataset.active="true",e.setAttribute("aria-pressed","true"))}const L=B.get("q");L&&p?(p.value=L,c=L,C().then(f)):f();
