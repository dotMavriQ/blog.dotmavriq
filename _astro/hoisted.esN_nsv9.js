import"./hoisted.DZlar31k.js";const R=6,w=document.getElementById("blog-search"),F=document.querySelectorAll("#blog-grid > a"),b=document.querySelectorAll('[data-js="tag-filter"] button'),h=document.getElementById("filter-count"),y=document.querySelector('[data-tag="__all__"]'),D=document.getElementById("load-more-btn"),A=document.getElementById("load-more-wrap"),l=new Set;let c="",v=R,M,p=null,B=null,E=!1;async function I(){if(!(p||E)){E=!0;try{p=await(await fetch("/search-index.json")).json(),B=new Map(p.map(e=>[e.slug,e]))}catch{}E=!1}}function G(){const t=new URL(window.location.href);l.size?t.searchParams.set("tags",[...l].join(",")):t.searchParams.delete("tags"),c?t.searchParams.set("q",c):t.searchParams.delete("q"),history.replaceState(null,"",t)}function H(t,e,s){if(Math.abs(t.length-e.length)>s)return s+1;const r=Array.from({length:e.length+1},(a,n)=>n),o=new Array(e.length+1);for(let a=1;a<=t.length;a++){o[0]=a;for(let n=1;n<=e.length;n++)o[n]=t[a-1]===e[n-1]?r[n-1]:1+Math.min(r[n-1],r[n],o[n-1]);for(let n=0;n<=e.length;n++)r[n]=o[n]}return r[e.length]}function Z(t){return t<=4?0:t<=7?1:t<=11?2:3}function J(t,e){let s=0;const r=Z(t.length);for(const o of e){if(o===t){s=Math.max(s,100);break}if(o.startsWith(t)){s=Math.max(s,85);continue}if(r>0){const a=H(t,o,r);a<=r&&(s=Math.max(s,70-a*15))}}return s}function m(t,e){if(!e.length)return 0;let s=0;for(const r of t){const o=J(r,e);if(o===0)return 0;s+=o}return s/t.length}function u(t){return t.toLowerCase().split(/[\s,.:;!?'"_\-/\\()\[\]{}|]+/).filter(e=>e.length>0)}function K(t){if(!c)return 1;const e=c.toLowerCase(),s=u(e);if(!s.length)return 1;const r=t.dataset.slug||"",o=B?.get(r),a=t.dataset.title||"",n=t.dataset.excerpt||"",i=t.dataset.tags||"",d=o?.body??"",q=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),S=s.length===1?new RegExp(`\\b${q}\\b`):null,g=_=>S?S.test(_.toLowerCase()):_.toLowerCase().includes(e);if(g(a))return 1e3;if(g(d))return 500;if(g(i))return 450;if(g(n))return 400;const P=u(a),W=u(n),$=u(i),T=d?u(d):[],k=m(s,P)*4,z=m(s,$)*2.5,Q=m(s,W)*1.5,U=m(s,T)*1,x=Math.max(k,z,Q,U);return x>0?x:0}function f(){const t=!l.size,e=!!c||!t,s=[];if(F.forEach(a=>{const n=a.dataset.tags?.split(",")??[],i=t||[...l].every(d=>n.includes(d));s.push({el:a,score:i?K(a):0})}),c){s.sort((n,i)=>i.score-n.score);const a=document.getElementById("blog-grid");if(a)for(const{el:n}of s)a.appendChild(n)}let r=0,o=0;s.forEach(({el:a,score:n})=>{if(n>0){r++;const i=e||r<=v;a.classList.toggle("card-hidden",!i),i&&o++}else a.classList.add("card-hidden")}),y&&(y.dataset.active=String(t),y.setAttribute("aria-pressed",String(t))),A&&A.classList.toggle("hidden",e||v>=r),h&&(t&&!c?h.classList.add("hidden"):(h.textContent=`${o} result${o!==1?"s":""}`,h.classList.remove("hidden"))),G()}b.forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.tag;e&&(e==="__all__"?(l.clear(),b.forEach(s=>{s.dataset.tag!=="__all__"&&(s.dataset.active="false",s.setAttribute("aria-pressed","false"))})):l.has(e)?(l.delete(e),t.dataset.active="false",t.setAttribute("aria-pressed","false")):(l.add(e),t.dataset.active="true",t.setAttribute("aria-pressed","true")),f())})});w?.addEventListener("input",()=>{clearTimeout(M),M=setTimeout(async()=>{c=w.value.trim(),c&&!p&&await I(),f()},150)});D?.addEventListener("click",()=>{v+=R,f()});const j=new URL(window.location.href).searchParams,C=j.get("tags");if(C)for(const t of C.split(",")){const e=document.querySelector(`[data-tag="${CSS.escape(t)}"]`);e&&(l.add(t),e.dataset.active="true",e.setAttribute("aria-pressed","true"))}const L=j.get("q");L&&w?(w.value=L,c=L,I().then(f)):f();
